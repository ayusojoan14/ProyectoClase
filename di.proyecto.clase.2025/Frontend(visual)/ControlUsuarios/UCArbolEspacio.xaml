<UserControl x:Class="di.proyecto.clase._2025.Frontend_visual_.ControlUsuarios.UCArbolEspacio"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:di.proyecto.clase._2025.Frontend_visual_.ControlUsuarios"
             xmlns:ent ="clr-namespace:di.proyecto.clase._2025.Backend.Modelos"
             mc:Ignorable="d"
             xmlns:mat="http://materialdesigninxaml.net/winfx/xaml/themes"
             x:Name="ucArbolEspacio"
             Loaded="ucArbolEspacio_Loaded"
             
             d:DesignHeight="450" d:DesignWidth="800">
    <DockPanel>
        <Grid DockPanel.Dock="Top">
            <TextBlock Text="ADMINISTRACIÓN DE ESPACIOS"
                       FontSize="28"
                       Foreground="DarkViolet"
                       HorizontalAlignment="Center"
                       Margin="10" />

        </Grid>


        <!-- ESTE ES EL ARBOL DE LA IZQUIERDA PUESTO EN LA IZQUIERDA *ATENCION* FALTAS DE ORTOGRAFIA -->
        <Grid DockPanel.Dock="Left" Width="300">
            <TreeView x:Name="treeEspacios" ItemsSource="{Binding listaespacios}"
                      SelectedItemChanged="treeViewArbol_SelectedItemChanged">
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type ent:Espacio}"
                                              ItemsSource="{Binding Articulos}">
                        <StackPanel Orientation="Horizontal">
                            <mat:PackIcon Kind="Cigarette" Width="16" Foreground="MediumVioletRed" />
                            <TextBlock Text="{Binding Nombre}" Margin="10,0,0,0"/>
                            <TextBlock>
                                <TextBlock.Text>
                                    <MultiBinding StringFormat=" ({0})">
                                        <Binding Path="Articulos.Count" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </StackPanel>
                    </HierarchicalDataTemplate>



                    <HierarchicalDataTemplate DataType="{x:Type ent:Articulo}"
                                              ItemsSource="{Binding Salida}">
                        <StackPanel Orientation="Horizontal">
                            <mat:PackIcon Kind="PackageVariant"
                                          Foreground="DarkViolet"
                                          Width="16" />
                            <TextBlock Text="{Binding Numserie}"
                                       Margin="10,0,0,0" />
                            <TextBlock FontWeight="Bold">
                            </TextBlock>
                        </StackPanel>

                    </HierarchicalDataTemplate>
                    <DataTemplate DataType="{x:Type ent:Salidum}">
                        <StackPanel Orientation="Horizontal">
                            <mat:PackIcon Kind="Sync"
                                          Foreground="#444"
                                          Width="16" />
                            <TextBlock Text="{Binding Fechasalida, StringFormat='dd/MM/yyyy'}"
                                       Foreground="#222"
                                       Margin="10,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </TreeView.Resources>
            </TreeView>
        </Grid>

        <!-- AQUI TERMINA EL ARBOL DE LA IZQUIERDA -->



        <Grid DockPanel.Dock="Bottom">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            
            <!-- ESTOS SON LOS FILTROS DE ABAJO  -->
            <TextBlock Text="MODIFICA LAS PROPIEDADES DEL ARTÍCULO" Margin="20" FontSize="16" Foreground="DarkViolet" Grid.ColumnSpan="3" />

            <TextBox Grid.Row="1" mat:HintAssist.Hint="Número de Serie" Text="{Binding articuloSeleccionado.Numserie}"  Margin="20,0,20,0" Width="150" />

            <ComboBox Grid.Row="2" mat:HintAssist.Hint="Estado del Articulo" ItemsSource="{Binding listaestado}" DisplayMemberPath="Nombre" SelectedItem="{Binding articuloSeleccionado.Estado}" Margin="20" Width="150"  />
            <DatePicker Grid.Row="1" Grid.Column="1" mat:HintAssist.Hint="Fecha de Alta"  Margin="20,0,20,0" Width="150" SelectedDate="{Binding articuloSeleccionado.Fechaalta}" />
            <ComboBox Grid.Row="2" Grid.Column="1" mat:HintAssist.Hint="Usuario" Margin="20" Width="150" DisplayMemberPath="Nombre" ItemsSource="{Binding listausuarios}" SelectedItem="{Binding articuloSeleccionado.UsuarioaltaNavigation}" />
            <ComboBox Grid.Row="1" Grid.Column="2" mat:HintAssist.Hint="Modelo del Articulo" Margin="20,0,20,0" Width="150" DisplayMemberPath="Nombre" ItemsSource="{Binding listaModeloArticulo}" SelectedItem="{Binding articuloSeleccionado.ModeloNavigation}" />
            <ComboBox Grid.Row="2" Grid.Column="2" mat:HintAssist.Hint="Departamento" Margin="20" Width="150" DisplayMemberPath="Nombre" ItemsSource="{Binding listadepartamentos}" SelectedItem="{Binding articuloSeleccionado.DepartamentoNavigation}" />
            <ComboBox Grid.Row="1" Grid.Column="3" mat:HintAssist.Hint="Espacio" Margin="20,0,20,0" Width="150" DisplayMemberPath="Nombre" ItemsSource="{Binding listaespacios}" SelectedItem="{Binding articuloSeleccionado.EspacioNavigation}" />
            <TextBox Grid.Row="2" Grid.Column="3" mat:HintAssist.Hint="Observaciones" Margin="20" Width="150" Text="{Binding articuloSeleccionado.Observaciones}"/>

            <Button Content="Modificar" Grid.Row="2" Grid.Column="4" x:Name="btnModificar" />
        </Grid>
        
        <!-- ESTE ES EL PANEL CENTRAL -->
        <Grid x:Name="panelCentral">
            <DataGrid x:Name="dgArticulosPorEspacio" AutoGenerateColumns="False"
                      Style="{StaticResource MahApps.Styles.DataGrid}"
                      ColumnWidth="*" CanUserAddRows="False" SelectedItem="{Binding articuloSeleccionado}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Numero de serie" Binding="{Binding Numserie}" />
                    <DataGridTextColumn Header="Modelo de articulo" Binding="{Binding ModeloNavigation.Nombre}" />
                    <DataGridTextColumn Header="Usuario" Binding="{Binding UsuarioaltaNavigation.Nombre}" />
                    <DataGridTemplateColumn Header="Fecha de Alta">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <DatePicker SelectedDate="{Binding Fechaalta}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </DockPanel>

</UserControl>
